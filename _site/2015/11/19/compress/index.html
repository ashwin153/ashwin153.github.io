<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="The work and thoughts of a programmer">

    <title>Compression - Ashwin Madavan</title>

    <link rel="canonical" href="http://ashwin153.github.io/2015/11/19/compress/">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/clean-blog.css">

    <!-- Pygments Github CSS -->
    <link rel="stylesheet" href="/css/syntax.css">

    <!-- Custom Fonts -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href='//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>


<body>

    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Ashwin Madavan</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="/">Home</a>
                </li>
                
                <li>
                    <a href="/about/">About</a>
                </li>
                
                <li>
                    <a href="/contact/">Contact</a>
                </li>
                
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>


    <!-- Post Header -->
<header class="intro-header" style="background-image: url('/img/compress-bg.png')">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <h1>Compression</h1>
                    
                    <h2 class="subheading">Bigger isn't always better</h2>
                    
                    <span class="meta">Posted by Ashwin Madavan on November 19, 2015</span>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">

				<h1 id="introduction">Introduction</h1>
<p>My compression algorithm uses curve fitting to model the bytes in a file as a <strong>function</strong> of their position in the file.</p>

<h1 id="expressions">Expressions</h1>
<p>Expressions are one-dimensional functions that can be evaluated at various values in a thread-safe manner. Expressions are compositions of simpler operations like addition, multiplication, and sine.</p>

<h3 id="stack-expressions">Stack Expressions</h3>
<p>Stack expressions are expressions that store their operations in reverse polish notation (RPN). RPN is a type of mathematical notation in which operations appear after their operands. For example, the expression 2+3-4 would be represented in RPN as 23+4-. The benefit of RPN is that expressions can be evaluated in a single pass without regard for order of operations using a single stack.</p>

<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="lineno"> 1</span> <span class="nd">@Override</span>
<span class="lineno"> 2</span> <span class="kd">public</span> <span class="n">BigDecimal</span> <span class="nf">eval</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
<span class="lineno"> 3</span> 	<span class="n">Stack</span><span class="o">&lt;</span><span class="n">BigDecimal</span><span class="o">&gt;</span> <span class="n">stack</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Stack</span><span class="o">&lt;</span><span class="n">BigDecimal</span><span class="o">&gt;();</span>
<span class="lineno"> 4</span> 	<span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">_operations</span><span class="o">.</span><span class="na">size</span><span class="o">();</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
<span class="lineno"> 5</span> 		<span class="n">BigDecimal</span><span class="o">[]</span> <span class="n">operands</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BigDecimal</span><span class="o">[</span><span class="n">_operations</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">i</span><span class="o">).</span><span class="na">arity</span><span class="o">()];</span>
<span class="lineno"> 6</span> 		<span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">operands</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="n">j</span><span class="o">++)</span>
<span class="lineno"> 7</span> 			<span class="n">operands</span><span class="o">[</span><span class="n">j</span><span class="o">]</span> <span class="o">=</span> <span class="n">stack</span><span class="o">.</span><span class="na">pop</span><span class="o">();</span>
<span class="lineno"> 8</span> 		<span class="n">stack</span><span class="o">.</span><span class="na">push</span><span class="o">(</span><span class="n">_operations</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">i</span><span class="o">).</span><span class="na">eval</span><span class="o">(</span><span class="n">operands</span><span class="o">));</span>
<span class="lineno"> 9</span> 	<span class="o">}</span>
<span class="lineno">10</span> 		
<span class="lineno">11</span> 	<span class="k">if</span><span class="o">(</span><span class="n">stack</span><span class="o">.</span><span class="na">size</span><span class="o">()</span> <span class="o">!=</span> <span class="mi">1</span><span class="o">)</span> 
<span class="lineno">12</span> 		<span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalArgumentException</span><span class="o">(</span><span class="s">&quot;Invalid stack expression&quot;</span><span class="o">);</span>
<span class="lineno">13</span> 	<span class="k">return</span> <span class="n">stack</span><span class="o">.</span><span class="na">pop</span><span class="o">();</span>
<span class="lineno">14</span> <span class="o">}</span></code></pre></div>

<h3 id="tree-expressions">Tree Expressions</h3>
<p>Tree expressions are expressions that store their operations in an expression tree. Each node of the expression tree represents an operation, whose inputs are the outputs of its child nodes. The image below shows the corresponding expression tree for the expression (4+3*7)-(5/(3+4))+6.</p>

<p><img align="center" style="margin: 0 auto; display: block;" src="/img/compress-tree.jpg" /></p>

<p>The most important benefit of tree expressions is that evaluation is easily parallelized; the children of any particular node can be evaluated independently. The code below parallelizes the evaluation of each node in the tree.</p>

<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="lineno"> 1</span> <span class="kd">public</span> <span class="n">BigDecimal</span> <span class="nf">eval</span><span class="o">(</span><span class="kd">final</span> <span class="n">ExecutorService</span> <span class="n">executor</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
<span class="lineno"> 2</span> 	<span class="c1">// Evaluates the node in parallel; we can do this because each child</span>
<span class="lineno"> 3</span> 	<span class="c1">// can be evaluated independently. This should lead to a huge</span>
<span class="lineno"> 4</span> 	<span class="c1">// performance boost of tree expression evaluation.</span>
<span class="lineno"> 5</span> 	<span class="n">List</span><span class="o">&lt;</span><span class="n">Future</span><span class="o">&lt;</span><span class="n">BigDecimal</span><span class="o">&gt;&gt;</span> <span class="n">tasks</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Future</span><span class="o">&lt;</span><span class="n">BigDecimal</span><span class="o">&gt;&gt;();</span>
<span class="lineno"> 6</span> 	<span class="k">for</span><span class="o">(</span><span class="kd">final</span> <span class="n">Node</span> <span class="n">child</span> <span class="o">:</span> <span class="n">_children</span><span class="o">)</span> <span class="o">{</span>
<span class="lineno"> 7</span> 		<span class="n">tasks</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">executor</span><span class="o">.</span><span class="na">submit</span><span class="o">(</span><span class="k">new</span> <span class="n">Callable</span><span class="o">&lt;</span><span class="n">BigDecimal</span><span class="o">&gt;()</span> <span class="o">{</span>
<span class="lineno"> 8</span> 			<span class="nd">@Override</span>
<span class="lineno"> 9</span> 			<span class="kd">public</span> <span class="n">BigDecimal</span> <span class="nf">call</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
<span class="lineno">10</span> 				<span class="k">return</span> <span class="n">child</span><span class="o">.</span><span class="na">eval</span><span class="o">(</span><span class="n">executor</span><span class="o">);</span>
<span class="lineno">11</span> 			<span class="o">}</span>
<span class="lineno">12</span> 		<span class="o">}));</span>
<span class="lineno">13</span> 	<span class="o">}</span>
<span class="lineno">14</span> 			
<span class="lineno">15</span> 	<span class="c1">// Retrieve the value of the future tasks and perform the operation</span>
<span class="lineno">16</span> 	<span class="n">BigDecimal</span><span class="o">[]</span> <span class="n">inputs</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BigDecimal</span><span class="o">[</span><span class="n">_operation</span><span class="o">.</span><span class="na">arity</span><span class="o">()];</span>
<span class="lineno">17</span> 	<span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">inputs</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span>
<span class="lineno">18</span> 		<span class="n">inputs</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="n">tasks</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">i</span><span class="o">).</span><span class="na">get</span><span class="o">();</span>
<span class="lineno">19</span> 	<span class="k">return</span> <span class="n">_operation</span><span class="o">.</span><span class="na">eval</span><span class="o">(</span><span class="n">inputs</span><span class="o">);</span>
<span class="lineno">20</span> <span class="o">}</span></code></pre></div>

<p>Another benefit of tree expressions is that they can be easily manipulated and modified by simply changing nodes in the tree. The drawbacks with tree expressions include larger memory usage.</p>

<h3 id="benchmarks">Benchmarks</h3>

<h1 id="curve-fitting">Curve Fitting</h1>

<h3 id="least-squares-regression">Least Squares Regression</h3>

<h3 id="discrete-fourier-regression">Discrete Fourier Regression</h3>

<h3 id="genetic-regression">Genetic Regression</h3>

<h1 id="mitigating-error">Mitigating Error</h1>

<h3 id="modified-chunking-algorithm">Modified Chunking Algorithm</h3>

<h3 id="genetic-bit-weight-optimizer">Genetic Bit Weight Optimizer</h3>

<h1 id="encoding-and-decoding">Encoding and Decoding</h1>

<h3 id="java-serialization">Java Serialization</h3>

<h3 id="kryo-serialization">Kryo Serialization</h3>

<h3 id="custom-serialization">Custom Serialization</h3>

<h1 id="results">Results</h1>

<p>Cover photograph by <a href="http://www.data.gov.bc.ca/local/dbc/images/feature/img_bg_slider2.png">data.gov.bc.ca</a>.</p>


                <hr>

                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/2015/10/19/vix/" data-toggle="tooltip" data-placement="top" title="VIX Futures Roll">&larr; Previous Post</a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="/2015/12/11/os/" data-toggle="tooltip" data-placement="top" title="CS 439H: Operating Systems">Next Post &rarr;</a>
                    </li>
                    
                </ul>

            </div>
        </div>
    </div>
</article>

<hr>


    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    <li>
                        <a href="/feed.xml">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li>
                        <a href="https://www.facebook.com/ashwin.madavan">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-facebook fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li>
                        <a href="https://github.com/ashwin153">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                </ul>
                <p class="copyright text-muted">Copyright &copy; Ashwin Madavan 2015</p>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="/js/jquery.min.js "></script>

<!-- Bootstrap Core JavaScript -->
<script src="/js/bootstrap.min.js "></script>

<!-- Custom Theme JavaScript -->
<script src="/js/clean-blog.min.js "></script>


</body>

</html>
