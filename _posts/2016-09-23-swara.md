---
layout:         basic
title:          "Swara"
subtitle:       "Musical machine learning"
category:       "Projects"
date:           2016-09-23 04:20:00
author:         "Ashwin Madavan"
header-img:     img/swara-bg.jpg"
---

# Swara
[Swara](https://en.wikipedia.org/wiki/Swara) is my attempt at bringing musical machine learning to the masses. My ultimate objective is to build exciting musical applications such as algorithmic composition, fingerprinting, and musical translation. This is an area of active research (see, for example, [Google Magenta](https://magenta.tensorflow.org/welcome-to-magenta) and [Jukedeck](https://www.jukedeck.com/)). In this article, I'll describe my approach to the development of these musical applications and the various musical and machine learning models that enable them. The code is publicly available on [Github](https://github.com/ashwin153/swara).

# Musical Modeling
The first goal of Swara was to develop ```swara-music```, a library for programmatically representing music. The library provides a convenient representation for songs that both a mathematician and a musician can understand and appreciate. It acts as a liason between mathematicians and musicians by providing the former with access to the various musical elements of a song without obfuscating their underlying musical meaning. For example, a waltz tempo can be constructed using the library in the following manner.

```java
// Waltz Tempo.
final Tempo waltz = new Tempo.Builder()
    .withSignature(3, 4)
	    .withBpm(88)
		    .build();
			```

### Terminology
The ```swara-music``` library currently supports the following musical elements: ```Song```, ```Fragment```, ```Key```, ```Tempo```, ```Phrase```, ```Voice```, ```Chord```, and ```Note```. These simple musical primitives can be combined to form highly complex musical arrangements. For example, this [code](https://gist.github.com/ashwin153/d86292dbfc346b48d7e8f9e79db463fd) produces the following fragment of sheet music (rendered using [MuseScore 2](https://musescore.org/en/2.0)).

<img align="center" src="/img/sample-song.png"/>

This simple song fragment highlights some of the cool features of the ```swara-music``` library including: key and tempo changes, polyphony, multiple instruments, dynamics, and accidentals. The real beauty is in the code snippet that generated the song fragment - it reads just like music! 

### I/O
In order to facilitate interoperability, the ```swara-music``` library exposes the ```MusicReader``` and ```MusicWriter``` interfaces for writing and reading musical elements to and from various file types. The library currently supports MIDI and JSON (for python/js interoperability).

### Future Work
Under current development is support for the extraction of various musical features. Musical features are derived attributes of music such as genre and melody that are superfluous to the construction of the music itself. For example, a song is _composed_ of notes and the notes _form_ a chord progression. In this example, the chord progression is a derived property of the notes themselves and is a musical feature. Current musical features under development include ```Genre```, ```Dynamics```, ```Harmony```, ```Melody```, and ```Rhythm```.

# Machine Learning
The second goal of Swara was to write generalized machine learning models built on [Apache Commons Math](http://commons.apache.org/proper/commons-math/). The ```swara-learn``` library provides a set of machine learning models built in Java from first principles. **Disclaimer:** these are  not high-performance implementations; in fact, I'm more than certain that faster and more memory-efficient versions of these models exist. This library is simply the result of my genuine curiosity into the inner workings of artificial intelligence. Although I have written all the code, this is by no means a solo effort. Special thanks are due to [Stanford CS-229](http://cs229.stanford.edu) for its informative and rigorous explanations. Under current development are the following machine learning models:

### Markov Models
- ```DiscreteMarkovChain```
- ```HiddenMarkovModel```

### Neural Networks
- ```ForwardLayer```
- ```LstmLayer```
- ```ConvolutionalLayer```
- ```PoolingLayer```

# Applications
The third goal of Swara was to use the ```swara-music``` and ```swara-learn``` libraries to build exciting musical technologies. Under current development are the following applications in the ```swara-core``` library:

### Algorithmic Composition
Algorithmic composition is the application of machine learning techniques to generating original scores of music. Under current development are: a ```MarkovComposer``` built on Discrete Markov Chains, a ```NeuralComposer``` built on LSTM Neural Networks, and a ```RandomComposer``` built for benchmarking the other methods.

### Fingerprinting
Fingerprinting is the processes of generating a musical fingerprint; or a set of descriptors that uniquely define a piece of music. This musical fingerprint can then be used to perform musical identification and search. Under current development is the ```ShazamFingerprinter``` built off the [Shazam](http://www.ee.columbia.edu/~dpwe/papers/Wang03-shazam.pdf) paper.

### Musical Translation
Musical translation is the application of machine learning techniques to extracting musical information from audio input sources. It is the musical analogue of speech-to-text. Under current development is the ```MarkovTranslator``` built on Hidden Markov Models.

Cover photograph courtesy of the Lord himself [Kanye West](http://wallpapercave.com/kanye-west-graduation-wallpaper). 
